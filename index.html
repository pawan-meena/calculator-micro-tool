<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>License Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <style>
        .select2-container {
            max-width: 264px;
            width: max-content !important;
        }
        </style>
  <script>

      function displayResult(isHighRisk, provider) {
          const formContainer = document.querySelector('form');
          if (formContainer) {
              formContainer.innerHTML = `<!-- Return Button -->
<button onclick="location.reload()" class="mt-4 p-3 bg-gray-800 text-white rounded-lg shadow-md hover:bg-gray-600 transition-all flex items-center justify-center space-x-2">
    <span class="material-icons text-xl animate-spin-slow">refresh</span>
    <span class="text-sm font-medium">Return</span>
</button>

<!-- Result Message Container -->
<div class="flex items-center justify-center ">
    <div id="result-message" 
         class="p-6 rounded-xl shadow-xl text-center transition-opacity duration-500 scale-95 transform opacity-0"
         style="background-color: ${isHighRisk ? '#8B0000' : '#008000'}; color: white;">
        
        <!-- Animated Icon -->
        <span class="material-icons text-6xl ${isHighRisk ? 'animate-shake' : 'animate-bounce'}">
            ${isHighRisk ? 'error_outline' : 'verified'}
        </span>

        <!-- Heading -->
        <h1 class="text-3xl font-bold mt-2 uppercase animate-fade-in">
            ${isHighRisk ? 'HIGH RISK DRIVER' : 'SAFE DRIVER'}
        </h1>

        <!-- Description -->
        <p class="text-sm mt-2 opacity-90">
            ${isHighRisk ? 'Your history suggests you might be classified as a high-risk driver. Please consult your insurance provider for more details.' 
                        : 'You are not classified as a high-risk driver. However, always drive safely and responsibly!'}
        </p>
    </div>
</div>`;
              setTimeout(() => {
                  document.getElementById('result-message').style.opacity = 1;
              }, 100);
          }
      }

      function getConvictions() {
        
        const licenseTypeElement = document.querySelector('select');
        if (!licenseTypeElement) {
            return;
        }
        
        const licenseType = licenseTypeElement.value;
        const inputs = document.querySelectorAll('input');
        if (inputs.length < 2) {
            return;
        }
        
        const nonPayments = parseInt(inputs[0].value) || 0;
        const atFaultClaims = parseInt(inputs[1].value) || 0;
        
        const convictionElements = document.querySelectorAll('#convictions-container select');
        let minorConvictions = 0, majorConvictions = 0, criminalConvictions = 0;
        
        convictionElements.forEach(select => {
            if (select.selectedIndex !== -1) {
                const category = select.options[select.selectedIndex].parentNode.label;
                if (category === "MINOR") minorConvictions++;
                if (category === "MAJOR") majorConvictions++;
                if (category === "CRIMINAL") criminalConvictions++;
            }
        });

        return { licenseType, nonPayments, atFaultClaims, minorConvictions, majorConvictions, criminalConvictions };
      }
  </script>
  <script>  
const convictions = [
    {
        category: "MINOR",
        options: [
            { value: "fail-or-refuse-to-surrender-licence", text: "Fail or refuse to surrender licence" },
            { value: "fail-to-produce-evidence-of-insurance", text: "Fail to produce evidence of insurance" },
            { value: "fail-to-carry-insurance-card", text: "Fail to carry insurance card" },
            { value: "fail-to-carry-evidence-of-insurance", text: "Fail to carry evidence of insurance" },
            { value: "fail-to-disclose-particulars", text: "Fail to disclose particulars" },
            { value: "fail-to-notify-police", text: "Fail to notify police" },
            { value: "fail-to-make-written-report", text: "Fail to make written report" },
            { value: "backing-up-unsafe", text: "Backing up – unsafe/illegal/improper" },
            { value: "brakes-inadequate", text: "Brakes – none/inadequate/improper" },
            { value: "crowding-drivers-seat", text: "Crowding driver’s seat" },
            { value: "door-opening-illegal", text: "Door opening – illegal/obstructing traffic" },
            { value: "emergency-vehicle-safety", text: "Emergency vehicle – operating with no regard for safety" },
            { value: "driving-imprudently", text: "Driving imprudently" },
            { value: "driving-off-roadway", text: "Driving off roadway (including shoulder/sidewalk/median)" },
            { value: "flagman-disobeying", text: "Flagman – disobeying" },
            { value: "following-too-closely", text: "Following too closely (including tailgating)" },
            { value: "headlights-improper-use", text: "Headlights/parking lights – improper/lack of use" },
            { value: "lack-control-vehicle", text: "Lack of control of vehicle" },
            { value: "passing-infraction", text: "Passing infraction except school bus or school/playground zone" },
            { value: "pedestrian-crossing", text: "Pedestrian crossing violation" },
            { value: "radar-warning-device", text: "Radar warning device in motor vehicle – if illegal in province/territory" },
            { value: "railway-crossing", text: "Railway crossing" },
            { value: "safety-zone-violation", text: "Safety zone violation" },
            { value: "seatbelt-offense", text: "Seatbelt – any offence" },
            { value: "signaling-offences", text: "Signaling offences" },
            { value: "slow-driving-endangering", text: "Slow driving – endangering others – other type" },
            { value: "smokescreen-device", text: "Smokescreen device on vehicle" },
            { value: "speeding-under-50", text: "Speeding under 50 km" },
            { value: "squealing-tires", text: "Squealing tires" },
            { value: "stopping-illegal", text: "Stopping – illegal/improper" },
            { value: "tires-defective", text: "Tires – defective/worn" },
            { value: "towing-unsafe", text: "Towing – prohibited/unsafe" },
            { value: "traffic-signals", text: "Traffic signals/regulating light" },
            { value: "traffic-signs-disobeying", text: "Traffic signs – disobeying any legal sign except parking regulations" },
            { value: "trailer-improper", text: "Trailer – improper attachments/improper towing" },
            { value: "turns-illegal", text: "Turns – illegal/improper" },
            { value: "unlicensed-driver", text: "Unlicensed driver including improper licence class" },
            { value: "unsafe-move", text: "Unsafe move" },
            { value: "unsafe-vehicle", text: "Unsafe vehicle" },
            { value: "wrong-side-road", text: "Wrong side of road/wrong way" },
            { value: "yield-failing", text: "Yield, failing to including failing to yield to a public bus" }
        ]
    },
    {
        category: "MAJOR",
        options: [
            { value: "fail-to-report-damage", text: "Failing to report damage to highway property" },
            { value: "fail-to-stop-police", text: "Failure to stop on request of or obey directions of a police officer" },
            { value: "fail-to-report-accident", text: "Failing to report an accident" },
            { value: "fail-to-give-name", text: "Failing, in the event of an accident, to give name and licence number" },
            { value: "fail-to-obey-school-sign", text: "Fail to obey school crossing stop sign" },
            { value: "fail-to-slow-emergency", text: "Fail to slow for emergency vehicle/tow truck" },
            { value: "improper-passing-school-bus", text: "Improper passing of a school bus" },
            { value: "improper-passing-school-zone", text: "Improper passing/speeding in a school or playground zone" }
        ]
    },
    {
        category: "CRIMINAL",
        options: [
            { value: "speeding-over-50", text: "Speeding 50 Kph or more over the speed limit" },
            { value: "driving-without-insurance", text: "Driving without insurance" },
            { value: "operating-vehicle-without-insurance", text: "Operating vehicle without insurance" },
            { value: "criminal-negligence-operation", text: "Criminal negligence committed in the operation or use of a motor vehicle" },
            { value: "manslaughter-operation-vehicle", text: "Manslaughter committed in the operation or use of a motor vehicle" }
        ]
    }
];


function addConvictionRow() {
    const container = document.getElementById('convictions-container');
    container.classList.add('pb-3');
    const row = document.createElement('div');
    row.className = "flex space-x-2 items-center p-3 pt-0 pb-0";
    const select = document.createElement('select');
 
    select.className = "w-full p-3 pawan-select border  min-w-[300px] rounded-lg focus:outline-none focus:ring-1 focus:ring-black mt-1";
    convictions.forEach(group => {
        const optgroup = document.createElement('optgroup');
        optgroup.label = group.category;

        group.options.forEach(option => {
            const opt = document.createElement('option');
            opt.value = option.value;
            opt.textContent = option.text;
            optgroup.appendChild(opt);
        });

        select.appendChild(optgroup);
    });
    const input = document.createElement('input');
    input.type = "number";
    input.min = "0";
    input.className = " p-1 m-2  border rounded-lg focus:outline-none focus:ring-1 min-w-[50px] focus:ring-black w-1/5 text-right";
    const removeButton = document.createElement('button');
    removeButton.type = "button";
    removeButton.className = "p-2 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none";
    removeButton.textContent = "✕";
    removeButton.addEventListener("click", () => row.remove());
    row.appendChild(select);
    row.appendChild(input);
    row.appendChild(removeButton);
    container.appendChild(row);

    $(".pawan-select").select2({
    placeholder: "",
    allowClear: true
});
}


    </script>

<style>
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    .animate-bounce {
      animation: bounce 1s infinite;
    }
    
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-5px); }
    }
    .animate-shake {
      animation: shake 0.5s infinite;
    }
    
    @keyframes fade-in {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }
    .animate-fade-in {
      animation: fade-in 0.6s ease-in-out;
    }
    
    @keyframes spin-slow {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }
    .animate-spin-slow {
      animation: spin-slow 2s linear infinite;
    }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-6 relative">
    
    <!-- Background Image with Overlay -->
    <div class="absolute inset-0 bg-black bg-opacity-60" style="background: url('/images/bg.jpg') no-repeat center center/cover;"></div>
  
    <!-- Main Container -->
    <div class="bg-white bg-opacity-80 p-4 rounded-2xl shadow-2xl w-full max-w-4xl border border-gray-300 flex flex-col md:flex-row relative z-10">
        
        <!-- Left Column (Form) -->
        <div class="w-full md:w-1/2 p-4">
            <h4 class="text-2xl font-bold text-center text-gray-900 border-b pb-4">HIGH RISK DRIVER ASSESSOR</h4>
            <form class="space-y-4 mt-6">
                
                <!-- License Type & Years Licensed in Same Row -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex items-start border rounded-lg p-3 shadow-sm bg-white bg-opacity-80 w-full">
                        <div class="w-full">
                            <label class="flex items-center text-gray-800 font-semibold"> 
                                <span class="material-icons text-blue-600 text-2xl">badge</span>
                                <span class="pl-2">License Type</span>
                            </label>
                            <select class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-600 mt-1">
                                <option value="g">G</option>
                                <option value="g1-g2">G1/G2</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="flex items-start border rounded-lg p-3 shadow-sm bg-white bg-opacity-80 w-full">
                        <div class="w-full">
                            <label class="flex items-center text-gray-800 font-semibold"> 
                                <span class="material-icons text-green-600 text-2xl">calendar_today</span>
                                <span class="pl-2">Years Licensed</span>
                            </label>
                            <input type="number" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600 mt-1" min="0" >
                        </div>
                    </div>
                </div>
  
                <!-- Number of Non-Payments -->
                <div class="flex items-start border rounded-lg p-3 shadow-sm bg-white bg-opacity-80">
                    <div class="w-full">
                        <label class="flex items-center text-gray-800 font-semibold"> 
                            <span class="material-icons text-red-600 text-2xl">payment</span>
                            <span class="p-1">Number of Non-Payments (3 years)</span>
                        </label>
                        <input type="number" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600 mt-1" min="0" >
                    </div>
                </div>
  
                <!-- Number of At-Fault Claims -->
                <div class="flex items-start border rounded-lg p-3 shadow-sm bg-white bg-opacity-80">
                    <div class="w-full">
                        <label class="flex items-center text-gray-800 font-semibold">
                            <span class="material-icons text-yellow-600 text-2xl">report_problem</span>
                            <span class="p-1">Number of At-Fault Claims (3 years)</span>
                        </label>
                        <input type="number" class="w-full p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-yellow-600 mt-1" min="0" >
                    </div>
                </div>
                
                <div id="convictions-container" class="rounded-lg bg-white bg-opacity-80">
                    <div class="flex items-center justify-between rounded-lg p-3 shadow-sm bg-white bg-opacity-80">
                        <div class="flex items-center">
                            <span class="material-icons text-purple-600 text-2xl">gavel</span>
                            <label class="ml-4 text-gray-800 font-semibold">Convictions (3 years)</label>
                        </div>
                        <button type="button" class="p-2 bg-black text-white rounded-lg flex items-center gap-1" onclick="addConvictionRow()">
                            <span class="material-icons">add</span>
                        </button>
                    </div>
                </div>
                
                <div class="flex justify-center">
                    <button type="submit" class="w-full max-w-[250px] p-3 bg-black text-white rounded-lg uppercase flex items-center justify-center gap-2 shadow-lg hover:bg-gray-800">
                        <span class="material-icons">search</span> Am I High-Risk?
                    </button>
                </div>
            </form>
        </div>
        
        <!-- Right Column (Text Information) -->
        <div class="w-full md:w-1/2 p-6 bg-gray-50 bg-opacity-80 rounded-2xl flex flex-col justify-center border border-gray-300">
            <h2 class="text-xl font-bold text-gray-900">HIGH-RISK DRIVER ASSESSMENT TOOL</h2>
            <p class="text-sm text-gray-600 mt-4">In Ontario, multiple insurers offer auto insurance, each with its own risk appetite. If your current insurance company drops you for exceeding their risk profile—whether due to the number or type of convictions, at-fault claims, or other factors—it doesn’t necessarily mean you are high-risk. You may still qualify for coverage in the regular market.</p>
            <p class="text-sm text-gray-600 mt-4">Our HRDA tool simplifies these complex rules to provide broad guidance on where you stand. While outright high-risk factors like fraud or misrepresentation have been omitted, the tool captures the most common reasons drivers lose coverage.</p>
            <p class="text-sm font-semibold text-gray-800 text-center mt-6">FOR A DEFINITIVE ASSESSMENT CONSULT YOUR BROKER OR INSURER</p>
        </div>
    </div>
  
  



<script>
     // AVIVA
    function checkRisk() {
        const { licenseType, nonPayments, atFaultClaims, minorConvictions, majorConvictions, criminalConvictions } = getConvictions();
      
        let isHighRisk = false;
        
        if (licenseType === "g") {
            if (atFaultClaims > 2 || criminalConvictions >= 1 || majorConvictions >= 1 || minorConvictions >= 6 || nonPayments >= 3) {
                isHighRisk = true;
            }
        } else if (licenseType === "g1-g2") {
            if (atFaultClaims >= 1 || criminalConvictions >= 1 || majorConvictions >= 1 || minorConvictions >= 3 || nonPayments >= 1) {
                isHighRisk = true;
            }
        }

        return isHighRisk;
    }
        
    document.addEventListener('DOMContentLoaded', function() {
      const submitButton = document.querySelector('button[type="submit"]');
      if (submitButton) {
          submitButton.addEventListener('click', function(event) {
              event.preventDefault();
              const avivaHighRisk = checkRisk();
              const uniqaHighRisk = checkRiskUNIQA();
              const wawaHighRisk = checkRiskWAWA();
                                        
              const isHighRisk = avivaHighRisk && uniqaHighRisk && wawaHighRisk;
              
              console.log({
                  AVIVA: avivaHighRisk,
                  UNIQA: uniqaHighRisk,
                  WAWA: wawaHighRisk,
          });      
              displayResult(isHighRisk);
          });
      }
    });
</script>
<script>
    function checkRiskUNIQA() {
        const { licenseType, nonPayments, atFaultClaims, minorConvictions, majorConvictions, criminalConvictions } = getConvictions();
        
        let isHighRisk = false;
        
        if ((licenseType === "g" || licenseType === "g1-g2") && (atFaultClaims >= 2)) {
            isHighRisk = true;
        }
        if ((licenseType === "g" || licenseType === "g1-g2") && (atFaultClaims >= 1 && minorConvictions >= 3)) {
            isHighRisk = true;
        }
        if ((licenseType === "g" || licenseType === "g1-g2") && (atFaultClaims >= 2 && minorConvictions >= 2)) {
            isHighRisk = true;
        }
        if ((licenseType === "g" || licenseType === "g1-g2") && majorConvictions >= 1) {
            isHighRisk = true;
        }
        if ((licenseType === "g" || licenseType === "g1-g2") && criminalConvictions >= 1) {
            isHighRisk = true;
        }
        if ((licenseType === "g" || licenseType === "g1-g2") && minorConvictions >= 3) {
            isHighRisk = true;
        }
        if ((licenseType === "g" || licenseType === "g1-g2") && nonPayments >= 2) {
            isHighRisk = true;
        }
        if ((licenseType === "g" || licenseType === "g1-g2") && atFaultClaims >= 1 && nonPayments >= 1) {
            isHighRisk = true;
        }
        if ((licenseType === "g" || licenseType === "g1-g2") && nonPayments >= 1 && minorConvictions >= 1) {
            isHighRisk = true;
        }
        
        return isHighRisk;
    }
</script>
<script>
    // WAWA
    function checkRiskWAWA() {
        const { licenseType, nonPayments, atFaultClaims, minorConvictions, majorConvictions, criminalConvictions } = getConvictions();
        
        let isHighRisk = false;
        
        // Direct conditions
        if (atFaultClaims >= 1 || criminalConvictions >= 1 || majorConvictions >= 1 || minorConvictions >= 3 || nonPayments >= 2) {
            isHighRisk = true;
        }
        
        if (atFaultClaims >= 2 && atFaultClaims <= 5) {
            isHighRisk = true;
        }
        
        // Combination rules
        if (minorConvictions >= 2 && nonPayments === 0 && atFaultClaims === 0) {
            isHighRisk = true;
        }
        if (nonPayments >= 1 && minorConvictions >= 2) {
            isHighRisk = true;
        }
        if (nonPayments >= 2 && atFaultClaims >= 1) {
            isHighRisk = true;
        }
        if (atFaultClaims >= 1 && minorConvictions >= 2) {
            isHighRisk = true;
        }
        if (nonPayments >= 1 && minorConvictions >= 1 && atFaultClaims >= 1) {
            isHighRisk = true;
        }
        
        return isHighRisk;
    }

 
</script>
</body>
</html>

